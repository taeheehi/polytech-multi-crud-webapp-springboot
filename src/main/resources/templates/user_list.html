<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>íšŒì› ëª©ë¡</title>

  <!-- âœ… ê³µí†µ ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="/home.css">
  <!-- âœ… í…Œì´ë¸” ì „ìš© ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="/user_list.css">
</head>
<body>

  <!-- âœ… ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
  <header class="navbar">
    <div class="nav-left">
      <a href="/" class="logo">í™ˆí˜ì´ì§€</a>
    </div>
    <div class="nav-right" id="nav-right">
      <!-- JSì—ì„œ ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ë™ì ìœ¼ë¡œ ì¶œë ¥ë¨ -->
    </div>
  </header>

  <!-- âœ… ë³¸ë¬¸ ì½˜í…ì¸  -->
  <main class="list-container">
    <h2>ğŸ“‹ ì „ì²´ íšŒì› ëª©ë¡ (ê´€ë¦¬ì ì „ìš©)</h2>

    <table class="user-table">
      <thead>
        <tr>
          <th>ë²ˆí˜¸</th>
          <th>ê¶Œí•œ</th>
          <th>ID</th>
          <th>ì´ë¦„</th>
          <th>ì—°ë½ì²˜</th>
          <th>ì£¼ì†Œ</th>
          <th>ê°€ì…ì¼</th>
          <th>ìˆ˜ì •ì¼</th>
        </tr>
      </thead>
      <tbody id="userTableBody">
        <!-- ğŸ” JSì—ì„œ fetchë¡œ ë™ì ìœ¼ë¡œ ì±„ì›€ -->
      </tbody>
    </table>

    <div class="button-area">
      <a href="/" class="back-btn">â† ëŒì•„ê°€ê¸°</a>
    </div>
  </main>

  <!-- âœ… JavaScript: ë¡œê·¸ì¸ ì„¸ì…˜ + íšŒì› ëª©ë¡ ë™ì  ì²˜ë¦¬ -->
  <script>
    // ğŸ” ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ í›„ ìƒë‹¨ ë©”ë‰´ ë Œë”ë§
    fetch("/sessionCheck")
      .then(res => res.json())
      .then(data => {
        let html = "";
        if (data.is_login) {
          html += `<span>${data.login_id}ë‹˜</span>`;
          html += `<a href="/mypage">ë§ˆì´í˜ì´ì§€</a>`;
          if (data.user_type === "admin") {
            html += `<a href="/user_list">íšŒì›ê´€ë¦¬</a>`;
          }
          html += `<a href="/logout">ë¡œê·¸ì•„ì›ƒ</a>`;
        } else {
          html += `<a href="/login">ë¡œê·¸ì¸</a>`;
          html += `<a href="/join">íšŒì›ê°€ì…</a>`;
        }
        document.getElementById("nav-right").innerHTML = html;
      });
                                                                     
    // ğŸ“‹ íšŒì› ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
    fetch("/getUsersJson")
      .then(res => res.json())
      .then(users => {
        let html = "";
        users.forEach((u, i) => {
          html += `
            <tr>
              <td>${i + 1}</td>
              <td>${u.userType}</td>
              <td>${u.id}</td>
              <td>${u.name}</td>
              <td>${u.phone}</td>
              <td>${u.address}</td>
              <td>${u.created}</td>
              <td>${u.lastUpdated}</td>
            </tr>
          `;
        });
        document.querySelector("#userTableBody").innerHTML = html;
      });
  </script>

</body>
</html>
